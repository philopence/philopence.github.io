<!doctype html><html lang=en>
<head>
<title>Arch_ins_conf :: Philopence's Blogs</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="archlinux的安装配置向导">
<meta name=keywords content=",">
<meta name=robots content="noodp">
<link rel=canonical href=https://philopence.github.io/posts/arch_ins_conf/>
<link rel=stylesheet href=https://philopence.github.io/assets/style.css>
<link rel=stylesheet href=https://philopence.github.io/style.css>
<link rel=apple-touch-icon href=https://philopence.github.io/img/apple-touch-icon-192x192.png>
<link rel="shortcut icon" href=https://philopence.github.io/img/favicon/orange.png>
<meta name=twitter:card content="summary">
<meta name=twitter:site content>
<meta name=twitter:creator content>
<meta property="og:locale" content="en">
<meta property="og:type" content="article">
<meta property="og:title" content="Arch_ins_conf">
<meta property="og:description" content="archlinux的安装配置向导">
<meta property="og:url" content="https://philopence.github.io/posts/arch_ins_conf/">
<meta property="og:site_name" content="Philopence's Blogs">
<meta property="og:image" content="https://philopence.github.io/">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">
<meta property="article:published_time" content="2021-12-28 11:23:54 +0800 +0800">
</head>
<body class=orange>
<div class="container headings--one-size">
<header class=header>
<div class=header__inner>
<div class=header__logo>
<a href=/>
<div class=logo>
Happy Hacking
</div>
</a>
</div>
<div class=menu-trigger>menu</div>
</div>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/about>About</a></li>
<li><a href=/showcase>Showcase</a></li>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/about>About</a></li>
<li><a href=/showcase>Showcase</a></li>
</ul>
</nav>
</header>
<div class=content>
<div class=post>
<h1 class=post-title>
<a href=https://philopence.github.io/posts/arch_ins_conf/>Arch_ins_conf</a></h1>
<div class=post-meta>
<span class=post-date>
2021-12-28
</span>
</div>
<span class=post-tags>
#<a href=https://philopence.github.io/tags/></a>&nbsp;
#<a href=https://philopence.github.io/tags/></a>&nbsp;
</span>
<div class=post-content><div>
<h2 id=01-pre_ins>01 Pre_Ins<a href=#01-pre_ins class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>systemctl stop reflector.service

iwctl <span style=color:#75715e># station wlan0 connect[-hidden] SSID</span>

timedatectl set-ntp true <span style=color:#75715e># timedatectl status</span>

fdisk -l
fdisk /dev/DISK

mkfs.fat -F32 /dev/EFI
mkfs.ext4 /dev/ROOT

mount /dev/ROOT /mnt
mkdir /mnt/boot
mount /dev/EFI /mnt/boot
</code></pre></div><h2 id=02-ins_base_pkgs>02 Ins_base_pkgs<a href=#02-ins_base_pkgs class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e>## https://mirrors.cloud.tencent.com/archlinux/$repo/os/$arch</span>
vim /etc/pacman.d/mirrorlist

pacstrap /mnt base base-devel linux linux-firmware fish neovim networkmanager grub efibootmgr intel-ucode
</code></pre></div><h2 id=03-conf-the-system>03 Conf the system<a href=#03-conf-the-system class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>genfstab -U /mnt &gt;&gt; /mnt/etc/fstab
arch-chroot /mnt

ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
hwclock --systohc

nvim /etc/locale.gen <span style=color:#75715e># uncomment en_US.UTF-8 and zh_CN.UTF-8</span>
locale-gen
nvim /etc/locale.conf <span style=color:#75715e># add LANG=en_US.UTF-8</span>

nvim /etc/hostname <span style=color:#75715e># set hostname</span>
nvim /etc/hosts
<span style=color:#75715e># 127.0.0.1 localhost</span>
<span style=color:#75715e># ::1 localhost </span>
<span style=color:#75715e># 127.0.1.1 linux.localdomain linux</span>
systemctl enable NetworkManager.service

passwd <span style=color:#75715e># root password</span>
useradd -m -G wheel -s /usr/bin/fish username
passwd username <span style=color:#75715e># user password</span>
EDITOR<span style=color:#f92672>=</span>nvim visudo <span style=color:#75715e># uncomment &#34;%wheel ALL=(ALL) ALL&#34;</span>
grub-install --target<span style=color:#f92672>=</span>x86_64-efi --efi-directory<span style=color:#f92672>=</span>/boot --bootloader-id<span style=color:#f92672>=</span>GRUB
grub-mkconfig -o /boot/grub/grub.cfg
</code></pre></div><h2 id=04-reboot>04 Reboot<a href=#04-reboot class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>exit
umount -R /mnt
reboot
</code></pre></div><h2 id=05-post_ins>05 Post_Ins<a href=#05-post_ins class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>nmcli device wifi connect SSID password PASSWORD <span style=color:#f92672>[</span>hidden yes<span style=color:#f92672>]</span>

<span style=color:#75715e># https://mirrors.cloud.tencent.com/archlinuxcn/$arch</span>
nvim /etc/pacman.conf <span style=color:#75715e># enable Colors and multilib, and archlinuxCN mirror</span>
sudo pacman -Syyu
sudo pacman -Sy archlinuxcn-keyring

<span style=color:#75715e>## WM and tools</span>
xorg xorg-xinit xdg-user-dirs xclip lxsession
xf86-video-intel vulkan-intel
alsa-utils pulseaudio-alsa bluez bluez-utils pulseaudio-bluetooth
noto-fonts noto-fonts-cjk noto-fonts-emoji nerd-fonts-jetbrains-mono
fcitx5-im fcitx5-rime fcitx5-material-theme
lxappearance qt5ct kvantum
capitaine-cursors papirus-icon-theme material-gtk-theme kvantum-material-theme
bspwm sxhkd kitty rofi picom dunst
git openssh npm feh scrot lazygit ripgrep ranger tmux hugo interception-caps2esc udiskie unarchiver
chromium code v2raya<span style=color:#f92672>(</span>v2ray<span style=color:#f92672>)</span> pomotroid-bin

<span style=color:#75715e>## TODO 用 dotfiles 替代</span>
~/.xinitrc <span style=color:#75715e># exec bspwm</span>
mkdir ~/.config/<span style=color:#f92672>{</span>bspwm,sxhkd<span style=color:#f92672>}</span>
cp /usr/share/doc/bspwm/examples/bspwmrc ~/.config/bspwm
cp /usr/share/doc/bspwm/examples/sxhkdrc ~/.config/sxhkd
<span style=color:#75715e># urxvt -&gt; kitty</span>
<span style=color:#75715e># dmenu_run -&gt; &#34;rofi -show run&#34;</span>

startx
</code></pre></div><h2 id=06-proxy>06 Proxy<a href=#06-proxy class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>Start/Enable v2raya.service deamon. Activite <code>localhost:2017</code>, import url of subscription</p>
<h2 id=07-dotfiles>07 Dotfiles<a href=#07-dotfiles class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>git clone --bare https://github.com/philopence/dotfiles.git $HOME/.dotfiles

alias dot <span style=color:#e6db74>&#39;/usr/bin/git --git-dir=$HOME/.dotfiles --work-tree=$HOME&#39;</span>

dot config --local status.showUntrackedFiles no

dot checkout <span style=color:#75715e># remove files and dirs of conflict</span>
</code></pre></div><h2 id=08-custom-keyboard>08 Custom Keyboard<a href=#08-custom-keyboard class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>Create <code>/etc/udev/hwdb.d/99-custom-keyboard.hwdb</code> file, add this lines as follow.</p>
<pre tabindex=0><code>evdev:input:b0003v*
 KEYBOARD_KEY_70039=leftctrl # bind capslock to leftctrl
 KEYBOARD_KEY_70035=capslock # bind grave to capslock
 KEYBOARD_KEY_700e0=grave    # bind leftctrl to grave
</code></pre><p>And then, run <code>systemd-hwdb update</code> and <code>udevadm trigger</code> command.</p>
<p>Or Install <code>interception-caps2esc</code> package, then edit <code>/etc/interception/udevmon.d/caps2esc.yaml</code> file, add this lines as follow:</p>
<pre tabindex=0><code>- JOB: intercept -g $DEVNODE | caps2esc -m 2 | uinput -d $DEVNODE
  DEVICE:
    EVENTS:
      EV_KEY: [KEY_CAPSLOCK, KEY_ESC]
</code></pre><p>Start/Enable udevmon.service deamon.</p>
<h2 id=09-swapfile>09 Swapfile<a href=#09-swapfile class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>switch to Root user</p>
<p>Note: count = 8192(8G)</p>
<pre tabindex=0><code>dd if=/dev/zero of=/swapfile bs=1M count=8192 status=progress
chmod 600 /swapfile
mkswap /swapfile
swapon /swapfile
nvim /etc/fstab
# /swapfile none swap defaults 0 0
</code></pre><h2 id=10-npm-pkgs>10 Npm pkgs<a href=#10-npm-pkgs class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<pre tabindex=0><code>prettier
live-server
@vue/cli

vscode-langservers-extracted
emmet-ls
vls
typescript
typescript-language-server
</code></pre>
</div></div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=https://philopence.github.io/posts/project_experience/>
<span class=button__icon>←</span>
<span class=button__text>Project_Experience</span>
</a>
</span>
<span class="button next">
<a href=https://philopence.github.io/posts/css/>
<span class=button__text>CSS</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<div class=copyright>
<span>© 2022 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span>
</div>
</div>
</footer>
<script src=https://philopence.github.io/assets/main.js></script>
<script src=https://philopence.github.io/assets/prism.js></script>
</div>
</body>
</html>